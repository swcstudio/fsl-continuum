[tool:pytest]
# Test Discovery
testpaths = src/tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test Execution
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --cov=src
    --cov-report=html
    --cov-report=xml
    --cov-report=term-missing
    --cov-fail-under=95
    --durations=10
    --maxfail=5
    --color=yes
    --reuse-db

# Coverage Configuration
cov-source = src
cov-branch = true
cov-context = test

# Markers
markers =
    unit: Unit tests for individual components
    integration: Integration tests for component interactions
    performance: Performance tests and benchmarking
    ai_processing: AI processing and validation tests
    xml_transformation: XML transformation tests
    baml: BAML (BoundaryML) specific tests
    pareto_lang: Pareto-Lang specific tests
    semantic_languages: Semantic language integration tests
    slow: Tests that take longer than 1 second
    external: Tests that require external services
    security: Security-related tests
    smoke: Smoke tests for basic functionality
    benchmark: Performance benchmarking tests
    coverage: Coverage-specific tests
    regression: Regression tests
    stress: Stress tests for performance validation

# Async Configuration
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Logging Configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Output Configuration
console_output_style = progress
junit_family = xunit2
junit_logging = all

# Min/Max Versions
minversion = 7.0
required_plugins = pytest-asyncio pytest-cov pytest-mock pytest-benchmark pytest-xvflaky

# Test Session Configuration
usefixtures = 
    test_environment
    test_data_manager
    test_monitoring

# Timeout Configuration
timeout = 300
timeout_method = thread

# Benchmark Configuration
benchmark-only = true
benchmark-sort = min
benchmark-min-rounds = 5
benchmark-max-time = 30
benchmark-warmup = true
benchmark-warmup-shutdown = true

# Performance Configuration
benchmark-storage = .benchmark
benchmark-histogram = true
benchmark-json = benchmark.json
benchmark-html = benchmark.html

# Security Configuration
bandit-tests = true
bandit-skips = []

# Memory Configuration
memory-profile = false
memory-profiler = true

# Parallel Configuration
parallel = false
parallel-workers = auto

# Retry Configuration
reruns = 0
reruns-delay = 1
flaky-reruns = 2

# Monkeypatch Configuration
monkeypatch-setenv = false

# Django Configuration (if needed)
django-settings-module = tests.settings

# Flask Configuration (if needed)
flask-app = tests.app

# Database Configuration (if needed)
db-keepdb = true
db-host = localhost
db-port = 5432
db-name = test_fsl_continuum
db-user = test_user
db-password = test_password

# Cache Configuration (if needed)
cache-url = redis://localhost:6379/1

# External Services Configuration
external-service-timeout = 30
external-service-retries = 3

# AI Configuration
openai-api-key = test_openai_key
anthropic-api-key = test_anthropic_key

# Performance Thresholds
performance-thresholds = {
    "baml-parsing": 0.1,
    "pareto-lang-parsing": 0.1,
    "xml-transformation": 0.5,
    "ai-processing": 2.0


# Memory Thresholds
memory-thresholds = {
    "baml-parsing": 50,
    "pareto-lang-parsing": 50,
    "xml-transformation": 100,
    "ai-processing": 200
}

# Coverage Thresholds
coverage-thresholds = {
    "unit": 95,
    "integration": 90,
    "performance": 80,
    "ai_processing": 85,
    "xml_transformation": 90
}

# Concurrency Configuration
concurrency-tests = true
concurrency-workers = 4

# Regression Configuration
regression-tests = false
regression-baseline = regression_baseline.json

# Stress Configuration
stress-tests = false
stress-duration = 300
stress-concurrency = 10

# Integration Configuration
integration-tests = true
integration-services = {
    "redis": true,
    "postgres": true,
    "openai": false,
    "anthropic": false
}

# Security Configuration
security-tests = true
security-scan = true
security-report = security_report.json

# Documentation Configuration
docs-tests = true
docs-coverage = 80

# Code Quality Configuration
code-quality-tests = true
code-quality-threshold = 8.0

# Type Checking Configuration
type-checking = true
type-checking-strict = false

# API Configuration
api-tests = true
api-host = localhost
api-port = 8080

# WebSocket Configuration
websocket-tests = true
websocket-uri = ws://localhost:8080/ws

# GraphQL Configuration
graphql-tests = true
graphql-endpoint = http://localhost:8080/graphql

# REST Configuration
rest-tests = true
rest-endpoint = http://localhost:8080/api

# File System Configuration
file-system-tests = true
test-data-dir = src/tests/fixtures
temp-dir = /tmp/fsl_continuum_tests

# Network Configuration
network-tests = true
network-timeout = 30

# Environment Configuration
test-env = test
test-config-file = tests/config/test_config.yaml
test-secrets-file = tests/config/test_secrets.yaml
